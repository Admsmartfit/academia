{% extends "admin/base.html" %}

{% block page_title %}Configuracoes do Sistema{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <i class="fas fa-cogs me-2"></i>
                Configuracoes do Sistema
            </div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('admin_settings.index') }}">
                    <!-- Secao: Creditos -->
                    <h5 class="mb-3">
                        <i class="fas fa-coins text-warning me-2"></i>
                        Sistema de Creditos
                    </h5>

                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label class="form-label">Creditos por Real (R$) *</label>
                            <div class="input-group">
                                <span class="input-group-text">1 R$ =</span>
                                <input type="number" name="credits_per_real" class="form-control"
                                       id="credits_per_real"
                                       value="{{ configs.credits_per_real.value }}"
                                       step="0.01" min="0.01" required>
                                <span class="input-group-text">creditos</span>
                            </div>
                            <small class="text-muted">
                                Define quantos creditos o cliente recebe por cada R$1,00 pago.
                            </small>
                        </div>

                        <div class="col-md-6">
                            <label class="form-label">Simulador</label>
                            <div class="input-group">
                                <span class="input-group-text">R$</span>
                                <input type="number" id="simulator_price" class="form-control"
                                       value="100" step="1" min="1">
                                <span class="input-group-text">=</span>
                                <input type="text" id="simulator_credits" class="form-control"
                                       readonly>
                                <span class="input-group-text">creditos</span>
                            </div>
                            <small class="text-muted">
                                Teste quanto creditos um pacote tera.
                            </small>
                        </div>
                    </div>

                    <div class="alert alert-info mb-4">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Como funciona:</strong><br>
                        <ul class="mb-0 mt-2">
                            <li>O cliente compra um pacote (ex: R$ 400)</li>
                            <li>O sistema converte para creditos automaticamente (ex: 400 creditos)</li>
                            <li>Cada tipo de aula (modalidade) tem um custo em creditos diferente</li>
                            <li>Ex: Musculacao = 1 credito, CrossFit = 2 creditos, Personal = 5 creditos</li>
                        </ul>
                    </div>

                    <hr class="my-4">

                    <!-- Secao: Dados da Academia -->
                    <h5 class="mb-3">
                        <i class="fas fa-building text-primary me-2"></i>
                        Dados da Academia
                    </h5>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Nome da Academia</label>
                            <input type="text" name="academy_name" class="form-control"
                                   value="{{ configs.academy_name.value }}"
                                   placeholder="Ex: Academia Fitness">
                        </div>

                        <div class="col-md-6">
                            <label class="form-label">Endereco</label>
                            <input type="text" name="academy_address" class="form-control"
                                   value="{{ configs.academy_address.value }}"
                                   placeholder="Ex: Rua da Academia, 123">
                        </div>
                    </div>

                    <hr class="my-4">

                    <div class="d-flex justify-content-end">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-2"></i>Salvar Configuracoes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Card de Ajuda -->
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <i class="fas fa-question-circle me-2"></i>
                Como usar os Creditos
            </div>
            <div class="card-body">
                <h6>Exemplo Pratico:</h6>
                <ol class="small">
                    <li>Configure: <strong>1 R$ = 1 credito</strong></li>
                    <li>Cliente compra pacote de <strong>R$ 400</strong></li>
                    <li>Cliente recebe <strong>400 creditos</strong></li>
                    <li>Aula de Yoga custa <strong>1 credito</strong></li>
                    <li>Aula de CrossFit custa <strong>2 creditos</strong></li>
                    <li>Cliente pode fazer:
                        <ul>
                            <li>400 aulas de Yoga, ou</li>
                            <li>200 aulas de CrossFit, ou</li>
                            <li>Combinacao de ambas</li>
                        </ul>
                    </li>
                </ol>

                <hr>

                <h6>Configurar Custo por Modalidade:</h6>
                <p class="small text-muted mb-2">
                    Acesse <strong>Modalidades</strong> para definir quantos creditos
                    cada tipo de aula consome.
                </p>
                <a href="{{ url_for('admin_modalities.list_modalities') }}" class="btn btn-outline-primary btn-sm">
                    <i class="fas fa-running me-1"></i>Configurar Modalidades
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{{ super() }}
<script>
// Simulador de creditos
function updateSimulator() {
    const creditsPerReal = parseFloat(document.getElementById('credits_per_real').value) || 1;
    const price = parseFloat(document.getElementById('simulator_price').value) || 0;
    const credits = Math.floor(price * creditsPerReal);
    document.getElementById('simulator_credits').value = credits;
}

document.getElementById('credits_per_real').addEventListener('input', updateSimulator);
document.getElementById('simulator_price').addEventListener('input', updateSimulator);

// Inicializar
updateSimulator();
</script>
{% endblock %}
